# SSL Server Allows Anonymous Authentication Vulnerability (13)
```
ServiceNow Vulnerability Report: QID 38142

```
### Vulnerability Details
```
QID: 38142
Title: SSL Anonymous Authentication Vulnerability
Port: 5666/tcp
Affected Nodes: 10.35.50.71–10.35.50.83
Description: Reports a service on 5666/tcp allowing anonymous SSL authentication, risking man-in-the-middle attacks.
PCI Vuln: Yes
```

### Scan Details
```
Tool Used: Nmap 7.92
Command:nmap -p 5666 10.35.50.71-83


Date: April 15, 2025
Executed From: Head node (kla-ac-hpc-01, Rocky Linux 9.5)
```

### Findings
```
Port Status: Port 5666/tcp is closed on all nodes (10.35.50.71–10.35.50.83), confirmed April 15, 2025.
Service Status: No service (e.g., Nagios NRPE) is running on 5666/tcp across any node.
Scan Output:[critical@kla-ac-hpc-01 ~]$ nmap -p 5666 10.35.50.71-83
Starting Nmap 7.92 ( https://nmap.org ) at 2025-04-15 08:49 EDT
Stats: 0:00:00 elapsed; 0 hosts completed (0 up), 13 undergoing Ping Scan
Parallel DNS resolution of 13 hosts. Timing: About 61.54% done; ETC: 08:49 (0:00:01 remaining)
Nmap scan report for 10.35.50.71
Host is up (0.00039s latency).


PORT     STATE  SERVICE
5666/tcp closed nrpe

Nmap scan report for 10.35.50.72
Host is up (0.00048s latency).

PORT     STATE  SERVICE
5666/tcp closed nrpe

Nmap scan report for 10.35.50.73
Host is up (0.00042s latency).

PORT     STATE  SERVICE
5666/tcp closed nrpe

Nmap scan report for 10.35.50.74
Host is up (0.00040s latency).

PORT     STATE  SERVICE
5666/tcp closed nrpe

Nmap scan report for 10.35.50.75
Host is up (0.00037s latency).

PORT     STATE  SERVICE
5666/tcp closed nrpe

Nmap scan report for 10.35.50.76
Host is up (0.00035s latency).

PORT     STATE  SERVICE
5666/tcp closed nrpe

Nmap scan report for 10.35.50.77
Host is up (0.00034s latency).

PORT     STATE  SERVICE
5666/tcp closed nrpe

Nmap scan report for 10.35.50.78
Host is up (0.00030s latency).

PORT     STATE  SERVICE
5666/tcp closed nrpe

Nmap scan report for 10.35.50.79
Host is up (0.00030s latency).

PORT     STATE  SERVICE
5666/tcp closed nrpe

Nmap scan report for 10.35.50.80
Host is up (0.00028s latency).

PORT     STATE  SERVICE
5666/tcp closed nrpe

Nmap scan report for 10.35.50.81
Host is up (0.00034s latency).

PORT     STATE  SERVICE
5666/tcp closed nrpe

Nmap scan report for 10.35.50.82
Host is up (0.00036s latency).

PORT     STATE  SERVICE
5666/tcp closed nrpe

Nmap scan report for 10.35.50.83
Host is up (0.00029s latency).

PORT     STATE  SERVICE
5666/tcp closed nrpe

Nmap done: 13 IP addresses (13 hosts up) scanned in 5.56 seconds
[critical@kla-ac-hpc-01 ~]$
```


### Reason for Detection:
```
Likely a false positive. The vulnerability scan may have:
Detected a temporary service on 5666/tcp (e.g., NRPE during a job or test) that is no longer active.
Misidentified another port or service due to inaccurate fingerprinting.
Captured a transient state during an image update or node reboot.
All nodes use a stateless Warewulf image, and no service is currently listening on 5666/tcp.
```

### Actions Taken
```
Nmap Usage:
Installed nmap (dnf install -y nmap) to perform the scan.
Uninstalled nmap (dnf remove -y nmap) after use to reduce security risks.
```

### Verification:
```
Confirmed all nodes online (ping successful).
Scan showed 5666/tcp closed on 10.35.50.71–83.
Prior openssl s_client -connect 10.35.50.71:5666 -cipher aNULL failed, reinforcing no SSL service.


Image Check (recommended):find /var/lib/warewulf/chroot/rocky9/etc -name "nrpe.cfg"
grep -r "5666" /var/lib/warewulf/chroot/rocky9/etc
```

### Recommendation
```
Status: Service on 5666/tcp is not running on 10.35.50.71–10.35.50.83.
Action:
Select "Ignore vulnerability" for QID: 38142, as no service is present.
Optionally, verify Warewulf image to ensure no service can start on 5666/tcp.
Rescan to clear QID: 38142.
Rescan Plan: Schedule post-ticket closure.
```

